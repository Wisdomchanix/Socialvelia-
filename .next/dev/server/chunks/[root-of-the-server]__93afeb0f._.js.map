{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///home/daniel/Social/app/api/idea/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\nimport { auth } from \"@/lib/auth\";\nimport { headers } from \"next/headers\";\nconst Ai = new GoogleGenerativeAI();\nexport const POST = async (req) => {\n  try {\n    const session = await auth.api.getSession({ headers: await headers() });\n    console.log({ session });\n    if (!session) {\n      return NextResponse.json(\n        { error: \"Please login to proceed\" },\n        { status: 401 }\n      );\n    }\n    const user = session.user;\n    if (user.plan === \"free\" && user.usageCount >= 2) {\n      return NextResponse.json(\n        { error: \"Free usage exceeded\" },\n        { status: 403 }\n      );\n    }\n    const { data, error } = await auth.api.updateUser({\n      body: {\n        usageCount: user.usageCount + 1,\n      },\n      headers: await headers(),\n    });\n    if (error) {\n      throw new Error(error);\n    }\n    const { prompt, purpose } = await req.json();\n    if (!prompt || !purpose)\n      return NextResponse.json(\n        { error: \"Missing required parameters\" },\n        { status: 400 }\n      );\n    if (![\"video\", \"image\", \"text\", \"audio\"].includes(purpose)) {\n      return res.status(400).json({\n        error: \"Valid purpose is required: video, image, text, or audio\",\n      });\n    }\n    const categoryTemplates = {\n      video: {\n        systemRole:\n          \"You are a professional AI video prompt engineer specializing in creating detailed, cinematic prompts for video generation models.\",\n        structure: `Create an enhanced video generation prompts based on the user's input.\n\nPROMPT STRUCTURE:\n1. CINEMATIC PROMPT: Focus on visual storytelling, camera movements, lighting, and atmosphere\n2. CONCEPTUAL PROMPT: Emphasize abstract ideas, metaphors, and artistic interpretation  \n3. PRACTICAL PROMPT: Clear, direct instructions for specific video types (tutorial, explainer, etc.)\n\nEach prompt should include:\n- Scene description with visual details\n- Camera movements and angles\n- Lighting and color palette\n- Style references (film genres, artists)\n- Mood and atmosphere\n- Technical specifications if applicable`,\n      },\n      image: {\n        systemRole:\n          \"You are an expert AI image prompt engineer with deep knowledge of visual arts, photography, and digital art styles.\",\n        structure: `Generate a sophisticated image generation prompts with different artistic approaches.\n\nPROMPT STRUCTURE:\n1. PHOTOGRAPHIC PROMPT: Realistic photography style with camera specs, lighting, composition\n2. ARTISTIC PROMPT: Specific art styles, painterly effects, creative interpretations\n3. CONCEPTUAL PROMPT: Abstract ideas, surrealism, imaginative scenes\n\nEach prompt must specify:\n- Subject and composition\n- Art style or medium (digital painting, oil painting, photo, etc.)\n- Lighting conditions and time of day\n- Color scheme and mood\n- Technical details (resolution, aspect ratio)\n- Artist influences or references`,\n      },\n      text: {\n        systemRole:\n          \"You are a master AI text prompt engineer specializing in crafting precise instructions for language models.\",\n        structure: `Create an optimized text generation prompts for different use cases.\n\nPROMPT STRUCTURE:\n1. CREATIVE PROMPT: Storytelling, creative writing, character development\n2. ANALYTICAL PROMPT: Research, analysis, explanation, technical writing\n3. PRACTICAL PROMPT: Instructions, emails, business writing, templates\n\nEach prompt should define:\n- Desired output format and length\n- Tone and style (formal, casual, academic, etc.)\n- Key points to cover\n- Target audience\n- Specific constraints or requirements`,\n      },\n      audio: {\n        systemRole:\n          \"You are an audio engineering expert specializing in AI music and sound generation prompts.\",\n        structure: `Generate a detailed audio generation prompts covering different sound types.\n\nPROMPT STRUCTURE:\n1. MUSICAL PROMPT: Music composition with genre, instruments, structure\n2. SOUNDSCAPE PROMPT: Ambient sounds, environmental audio, background noise\n3. EFFECTS PROMPT: Sound effects, vocal processing, audio manipulation\n\nEach prompt must include:\n- Genre or sound type\n- Instruments or sound sources\n- Tempo, rhythm, or duration\n- Mood and emotional tone\n- Technical specifications (bitrate, format if needed)\n- Reference artists or similar sounds`,\n      },\n    };\n    const template = categoryTemplates[category.split(\" \")[0].toLowerCase()];\n    const complexityLevels = {\n      basic: \"Keep prompts simple and straightforward\",\n      intermediate: \"Add moderate detail and creative elements\",\n      advanced: \"Include highly detailed, professional-level specifications\",\n    };\n    const promptTemplate = `\nSYSTEM ROLE: ${template.systemRole}\n\nUSER'S ORIGINAL INPUT: \"${userInput}\"\nCATEGORY: ${category.toUpperCase()} GENERATION\nCOMPLEXITY: ${complexity || \"intermediate\"}\nTARGET MODEL: ${targetModel || \"General AI\"}\n\n${template.structure}\n\nCOMPLEXITY GUIDELINES: ${\n      complexityLevels[complexity] || complexityLevels.intermediate\n    }\n\nADDITIONAL STYLE PREFERENCES: ${style || \"No specific style provided\"}\n\nIMPORTANT: Return ONLY valid JSON in this exact format:\n{\n  \"category\": \"${category}\",\n  \"originalInput\": \"${userInput}\",\n  \"generatedPrompt\": \n    {\n      \"type\": \"Prompt Type 3\",\n      \"prompt\": \"Full detailed prompt text here...\",\n      \"useCase\": \"When to use this prompt\", \n      \"strengths\": [\"Strength 1\", \"Strength 2\", \"Strength 3\"],\n      \"estimatedTokens\": 150,\n      \"modelOptimized\": true\n    },\n \n}\n\nEnsure each prompt is self-contained and ready to use with AI models.\n`;\n    const model = Ai.getGenerativeModel({\n      model: \"gemini-2.0-flash-exp\",\n      generationConfig: {\n        temperature: 0.8,\n        topK: 40,\n        topP: 0.95,\n        maxOutputTokens: 2048,\n      },\n    });\n    const result = await model.generateContent(promptTemplate);\n    const text = result.response.text();\n\n    console.log(\"Prompt Generation Raw Response:\", text);\n\n    let jsonResponse;\n    try {\n      const cleanedText = text.replace(/```json\\n?|\\n?```/g, \"\").trim();\n      jsonResponse = JSON.parse(cleanedText);\n    } catch (parseError) {\n      console.error(\"JSON Parse Error:\", parseError);\n\n      jsonResponse = createFallbackPrompts(\n        userInput,\n        category,\n        style,\n        complexity\n      );\n    }\n    return NextResponse.json(\n      {\n        message: \"Prompt generation successful\",\n        payload: {\n          jsonResponse,\n          data,\n          usageCount: data?.usageCount || (user.usageCount || 0) + 1,\n        },\n      },\n      { status: 200 }\n    );\n  } catch (error) {\n    console.error(error);\n    return NextResponse.json(\n      {\n        error:\n          process.env.NODE_ENV === \"production\"\n            ? \"Internal server error\"\n            : error.message,\n      },\n      { status: 500 }\n    );\n  }\n};\n"],"names":[],"mappings":"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","debugId":null}}]
}