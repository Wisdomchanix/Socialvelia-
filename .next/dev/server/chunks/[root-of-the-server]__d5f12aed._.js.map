{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 52, "column": 0}, "map": {"version":3,"sources":["file:///home/daniel/Social/lib/auth.js"],"sourcesContent":["import { betterAuth } from \"better-auth\";\nimport { prismaAdapter } from \"better-auth/adapters/prisma\";\nimport { PrismaClient } from \"@prisma/client\";\nconst prisma = new PrismaClient();\nexport const auth = betterAuth({\n  database: prismaAdapter(prisma, {\n    provider: \"postgresql\",\n  }),\n  secret: process.env.AUTH_SECRET,\n  baseURL: process.env.AUTH_URL,\n  emailAndPassword: {\n    enabled: true,\n  },\n\n  user: {\n    additionalFields: {\n      plan: {\n        type: \"enum\",\n        values: [\"free\", \"monthly\", \"pro\"],\n        required: true,\n        defaultValue: \"free\",\n      },\n      planDate: {\n        type: \"date\",\n        required: false,\n      },\n      usageCount: {\n        type: \"number\",\n        defaultValue: 0,\n        required: true,\n      },\n    },\n  },\n  session: {\n    expiresIn: 60 * 60 * 24 * 7, // 7 days\n    updateAge: 60 * 60 * 24, // 24 hours\n  },\n});\nexport { auth };\n{\n  /*  socialProviders: {\n    google: {\n      enabled: true,\n      clientId: process.env.GOOGLE_CLIENT_ID,\n      clientSecret: process.env.GOOGLE_CLIENT_SECRET,\n    },\n  },* */\n}\n"],"names":[],"mappings":";;;;AAAA;AAAA;AACA;AACA;;;;AACA,MAAM,SAAS,IAAI,6IAAY;AACxB,MAAM,OAAO,IAAA,8aAAU,EAAC;IAC7B,UAAU,IAAA,gaAAa,EAAC,QAAQ;QAC9B,UAAU;IACZ;IACA,QAAQ,QAAQ,GAAG,CAAC,WAAW;IAC/B,SAAS,QAAQ,GAAG,CAAC,QAAQ;IAC7B,kBAAkB;QAChB,SAAS;IACX;IAEA,MAAM;QACJ,kBAAkB;YAChB,MAAM;gBACJ,MAAM;gBACN,QAAQ;oBAAC;oBAAQ;oBAAW;iBAAM;gBAClC,UAAU;gBACV,cAAc;YAChB;YACA,UAAU;gBACR,MAAM;gBACN,UAAU;YACZ;YACA,YAAY;gBACV,MAAM;gBACN,cAAc;gBACd,UAAU;YACZ;QACF;IACF;IACA,SAAS;QACP,WAAW,KAAK,KAAK,KAAK;QAC1B,WAAW,KAAK,KAAK;IACvB;AACF;;AAEA;AACE;;;;;;MAMI,GACN","debugId":null}},
    {"offset": {"line": 109, "column": 10}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 113, "column": 0}, "map": {"version":3,"sources":["file:///home/daniel/Social/app/api/niche/route.js"],"sourcesContent":["import { NextResponse } from \"next/server\";\nimport { GoogleGenerativeAI } from \"@google/generative-ai\";\nimport { auth } from \"../../../lib/auth\";\nimport { headers } from \"next/headers\";\nconst Ai = new GoogleGenerativeAI(process.env.GEMINI_API_KEY);\nexport const POST = async (req) => {\n  try {\n    const session = await auth.api.getSession({ headers: await headers() });\n    console.log({ session });\n    if (!session) {\n      return NextResponse.json(\n        { error: \"Please login to proceed\" },\n        { status: 401 }\n      );\n    }\n    const user = session.user;\n    const { answers } = await req.json();\n    if (!answers || !Array.isArray(answers) || answers.length === 0) {\n      return NextResponse.json(\n        { error: \"Answers array is required\" },\n        { status: 400 }\n      );\n    }\n\n    const prompt = `\nYou are a YouTube niche expert specializing in faceless channels. Based on the user's answers below, suggest 2 perfect content niches for a faceless YouTube channel.\n\nUSER'S ANSWERS:\n${answers.map((a, i) => `${i + 1}. ${a}`).join(\"\\n\")}\n\nCRITERIA FOR FACELESS CHANNELS:\n- No personal appearance required\n- Can use voiceover, stock footage, animations, or screen recordings\n- Evergreen content potential\n- Monetization friendly\n- Searchable topics\n\nPlease analyze their interests, skills, and preferences to suggest niches that match these criteria.\n\nRespond ONLY with valid JSON in this exact format:\n{\n  \"niches\": [\n    { \n      \"name\": \"Niche Name 1\",\n      \"reason\": \"Detailed explanation why this fits their answers and works for faceless content\",\n      \"contentIdeas\": [\"Idea 1\", \"Idea 2\", \"Idea 3\"],\n      \"monetizationPotential\": \"High/Medium/Low\",\n      \"competitionLevel\": \"High/Medium/Low\",\n      \"trends\":[\"array of trends\"],\n      \"audience\":[\"array of audience\"],\n      \"ideas\":[\"array of ideas\"]\n    },\n    { \n      \"name\": \"Niche Name 2\", \n      \"reason\": \"Detailed explanation why this fits their answers and works for faceless content\",\n      \"contentIdeas\": [\"Idea 1\", \"Idea 2\", \"Idea 3\"],\n      \"monetizationPotential\": \"High/Medium/Low\",\n      \"competitionLevel\": \"High/Medium/Low\",\n      \"trends\":[\"array of trends\"],\n      \"audience\":[\"array of audience\"],\n      \"ideas\":[\"array of ideas\"]\n    }\n  ]\n}\n`;\n    const model = Ai.getGenerativeModel({\n      model: \"gemini-2.0-flash-exp\",\n      generationConfig: {\n        temperature: 0.7,\n        topK: 40,\n        topP: 0.95,\n        maxOutputTokens: 1024,\n      },\n    });\n    const result = await model.generateContent(prompt);\n\n    const text = result.response.text();\n    const { data, error } = await auth.api.updateUser({\n      body: {\n        usageCount: user.usageCount + 1,\n      },\n      headers: await headers(),\n    });\n    console.log({ data, error });\n    if (error) {\n      throw new Error(error);\n    }\n    console.log(\"Gemini Raw Response:\", text);\n    let jsonResponse;\n    try {\n      const cleanedText = text.replace(/```json\\n?|\\n?```/g, \"\").trim();\n      jsonResponse = JSON.parse(cleanedText);\n    } catch (parseError) {\n      console.error(\"JSON Parse Error:\", parseError);\n      const jsonMatch = text.match(/\\{[\\s\\S]*\\}/);\n      if (jsonMatch) {\n        try {\n          jsonResponse = JSON.parse(jsonMatch[0]);\n        } catch {\n          jsonResponse = {\n            error: \"Failed to parse AI response\",\n            fallback: true,\n            niches: [\n              {\n                name: \"Educational How-To Guides\",\n                reason:\n                  \"Based on your interests, creating step-by-step tutorial content works well for faceless channels\",\n                contentIdeas: [\n                  \"Software tutorials\",\n                  \"DIY projects\",\n                  \"Learning skills\",\n                ],\n                monetizationPotential: \"High\",\n                competitionLevel: \"Medium\",\n              },\n              {\n                name: \"Personal Finance & Investing\",\n                reason:\n                  \"Financial education content performs well with voiceover and graphics\",\n                contentIdeas: [\n                  \"Stock market analysis\",\n                  \"Budgeting tips\",\n                  \"Investment strategies\",\n                ],\n                monetizationPotential: \"High\",\n                competitionLevel: \"High\",\n              },\n            ],\n          };\n        }\n      } else {\n        jsonResponse = {\n          error: \"AI returned invalid format\",\n          fallback: true,\n          niches: [\n            {\n              name: \"Animation & Storytelling\",\n              reason:\n                \"Creative content that can be produced without showing your face\",\n              contentIdeas: [\n                \"Animated stories\",\n                \"Moral tales\",\n                \"Educational animations\",\n              ],\n              monetizationPotential: \"Medium\",\n              competitionLevel: \"Low\",\n            },\n          ],\n        };\n      }\n    }\n    return NextResponse.json(\n      {\n        message: \"Success generating niche\",\n        payload: {\n          jsonResponse,\n          user: data,\n          usageCount: data?.usageCount || (user.usageCount || 0) + 1,\n        },\n      },\n      { status: 200 }\n    );\n  } catch (error) {\n    console.error(error);\n    return NextResponse.json(\n      {\n        error:\n          process.env.NODE_ENV === \"production\"\n            ? \"Internal server error\"\n            : error.message,\n      },\n      { status: 500 }\n    );\n  }\n};\n"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;;;;;AACA,MAAM,KAAK,IAAI,gQAAkB,CAAC,QAAQ,GAAG,CAAC,cAAc;AACrD,MAAM,OAAO,OAAO;IACzB,IAAI;QACF,MAAM,UAAU,MAAM,qHAAI,CAAC,GAAG,CAAC,UAAU,CAAC;YAAE,SAAS,MAAM,IAAA,iWAAO;QAAG;QACrE,QAAQ,GAAG,CAAC;YAAE;QAAQ;QACtB,IAAI,CAAC,SAAS;YACZ,OAAO,qWAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA0B,GACnC;gBAAE,QAAQ;YAAI;QAElB;QACA,MAAM,OAAO,QAAQ,IAAI;QACzB,MAAM,EAAE,OAAO,EAAE,GAAG,MAAM,IAAI,IAAI;QAClC,IAAI,CAAC,WAAW,CAAC,MAAM,OAAO,CAAC,YAAY,QAAQ,MAAM,KAAK,GAAG;YAC/D,OAAO,qWAAY,CAAC,IAAI,CACtB;gBAAE,OAAO;YAA4B,GACrC;gBAAE,QAAQ;YAAI;QAElB;QAEA,MAAM,SAAS,CAAC;;;;AAIpB,EAAE,QAAQ,GAAG,CAAC,CAAC,GAAG,IAAM,GAAG,IAAI,EAAE,EAAE,EAAE,GAAG,EAAE,IAAI,CAAC,MAAM;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAoCrD,CAAC;QACG,MAAM,QAAQ,GAAG,kBAAkB,CAAC;YAClC,OAAO;YACP,kBAAkB;gBAChB,aAAa;gBACb,MAAM;gBACN,MAAM;gBACN,iBAAiB;YACnB;QACF;QACA,MAAM,SAAS,MAAM,MAAM,eAAe,CAAC;QAE3C,MAAM,OAAO,OAAO,QAAQ,CAAC,IAAI;QACjC,MAAM,EAAE,IAAI,EAAE,KAAK,EAAE,GAAG,MAAM,qHAAI,CAAC,GAAG,CAAC,UAAU,CAAC;YAChD,MAAM;gBACJ,YAAY,KAAK,UAAU,GAAG;YAChC;YACA,SAAS,MAAM,IAAA,iWAAO;QACxB;QACA,QAAQ,GAAG,CAAC;YAAE;YAAM;QAAM;QAC1B,IAAI,OAAO;YACT,MAAM,IAAI,MAAM;QAClB;QACA,QAAQ,GAAG,CAAC,wBAAwB;QACpC,IAAI;QACJ,IAAI;YACF,MAAM,cAAc,KAAK,OAAO,CAAC,sBAAsB,IAAI,IAAI;YAC/D,eAAe,KAAK,KAAK,CAAC;QAC5B,EAAE,OAAO,YAAY;YACnB,QAAQ,KAAK,CAAC,qBAAqB;YACnC,MAAM,YAAY,KAAK,KAAK,CAAC;YAC7B,IAAI,WAAW;gBACb,IAAI;oBACF,eAAe,KAAK,KAAK,CAAC,SAAS,CAAC,EAAE;gBACxC,EAAE,OAAM;oBACN,eAAe;wBACb,OAAO;wBACP,UAAU;wBACV,QAAQ;4BACN;gCACE,MAAM;gCACN,QACE;gCACF,cAAc;oCACZ;oCACA;oCACA;iCACD;gCACD,uBAAuB;gCACvB,kBAAkB;4BACpB;4BACA;gCACE,MAAM;gCACN,QACE;gCACF,cAAc;oCACZ;oCACA;oCACA;iCACD;gCACD,uBAAuB;gCACvB,kBAAkB;4BACpB;yBACD;oBACH;gBACF;YACF,OAAO;gBACL,eAAe;oBACb,OAAO;oBACP,UAAU;oBACV,QAAQ;wBACN;4BACE,MAAM;4BACN,QACE;4BACF,cAAc;gCACZ;gCACA;gCACA;6BACD;4BACD,uBAAuB;4BACvB,kBAAkB;wBACpB;qBACD;gBACH;YACF;QACF;QACA,OAAO,qWAAY,CAAC,IAAI,CACtB;YACE,SAAS;YACT,SAAS;gBACP;gBACA,MAAM;gBACN,YAAY,MAAM,cAAc,CAAC,KAAK,UAAU,IAAI,CAAC,IAAI;YAC3D;QACF,GACA;YAAE,QAAQ;QAAI;IAElB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC;QACd,OAAO,qWAAY,CAAC,IAAI,CACtB;YACE,OACE,sCACI,0BACA,MAAM,OAAO;QACrB,GACA;YAAE,QAAQ;QAAI;IAElB;AACF","debugId":null}}]
}